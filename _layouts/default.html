<!DOCTYPE html>
<html lang="{{ site.lang | default: "en-US" }}">
<head>
    <meta charset="UTF-8">

    {% seo %}
    <link rel="preconnect" href="https://fonts.gstatic.com">
    <link rel="preload" href="https://fonts.googleapis.com/css?family=Open+Sans:400,700&display=swap" as="style" type="text/css" crossorigin>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="theme-color" content="#157878">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="stylesheet" href="{{ '/assets/css/style.css?v=' | append: site.github.build_revision | relative_url }}">
    {% include head-custom.html %}
</head>
<body>
<a id="skip-to-content" href="#content">Skip to the content.</a>

<header class="page-header" role="banner">
    <h1 class="project-name">{{ page.title | default: site.title | default: site.github.repository_name }}</h1>
    <h2 class="project-tagline">{{ page.description | default: site.description | default: site.github.project_tagline }}</h2>
    {% if site.show_downloads %}
        <a href="{{ site.github.zip_url }}" class="btn">Download .zip</a>
        <a href="{{ site.github.tar_url }}" class="btn">Download .tar.gz</a>
    {% endif %}
    <div>
        {% assign institution_map = "" | split: "" %}
        {% assign institution_counter = 1 %}

        {% for author in site.authors %}
            {% for institution in author.institutions %}
                {% unless institution_map contains institution.name %}
                    {% assign institution_map = institution_map | push: institution.name %}
                    {% capture index %}{{ institution_counter }}{% endcapture %}
                    {% assign institution_counter = institution_counter | plus: 1 %}
                    {% assign institution_map = institution_map | push: index %}
                {% endunless %}
            {% endfor %}
        {% endfor %}

        {% assign institution_indexes = "" %}
        {% for institution in institution_map %}
            {% assign institution_indexes = institution_indexes | append: institution %}:
            {% assign next_index = forloop.index | plus: 1 %}
            {% if next_index <= institution_map.size %}
                {% assign institution_indexes = institution_indexes | append: institution_map[next_index] %}
            {% endif %}
            {% if forloop.index0 != forloop.last %}
                {% assign institution_indexes = institution_indexes | append: "," %}
            {% endif %}
        {% endfor %}

        {% capture get_index %}
            {% assign index = nil %}
            {% for pair in institution_indexes %}
                {% assign parts = pair | split: ":" %}
                {% if parts[0] == institution %}
                    {% assign index = parts[1] %}
                {% endif %}
            {% endfor %}
            {{ index }}
        {% endcapture %}

        <div>
            {% for author in site.authors %}
                {{ author.name }}
                {% for institution in author.institutions %}
                    {% capture institution_index %}
                        {% assign institution = institution.name %}
                        {{ get_index }}
                    {% endcapture %}
                    <sup>{{ institution_index }}</sup>{% if forloop.last == false %},{% endif %}
                {% endfor %}
                {% if forloop.last == false %}, {% endif %}
            {% endfor %}
        </div>

        <div>
            {% for institution in institution_map %}
                {% if forloop.index0 | modulo: 2 == 0 %}
                    {{ institution }}<sup>{{ institution_map[forloop.index0 | plus: 1] }}</sup>{% if forloop.last == false %}, {% endif %}
                {% endif %}
            {% endfor %}
        </div>
    </div>
</header>

<main id="content" class="main-content" role="main">
{{ content }}

<footer class="site-footer">
    {% if site.github.is_project_page %}
        <span class="site-footer-owner"><a href="{{ site.github.repository_url }}">{{ site.github.repository_name }}</a> is maintained by <a href="{{ site.github.owner_url }}">{{ site.github.owner_name }}</a>.</span>
    {% endif %}
    <span class="site-footer-credits">This page was generated by <a href="https://pages.github.com">GitHub Pages</a>.</span>
</footer>
</main>
</body>
</html>
